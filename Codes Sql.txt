1. What is the most common room type in NYC Airbnb listings?
SELECT COUNT (room_type) AS count,
        room_type
FROM room_types
GROUP BY room_type
ORDER BY count DESC;
13266 - entire home/apt
11356 - private room
587 - shared room

2.What is the average price of a listing by room type?
SELECT AVG(price) as avg_price,
        room_type
FROM prices p
JOIN room_types rt
    ON p.listing_id = rt.listing_id
GROUP BY room_type;
53.64 - shared room
197.16 - entire home/apt
81.67 - private room

3.Which borough has the highest average price per month?
SELECT AVG(price_per_month) as avg_price_month,
         borough
FROM prices
GROUP BY borough
ORDER BY avg_price_month DESC;
5596.68 - Manhattan

4.How many listings of each room type are in each borough?
SELECT COUNT(p.listing_id) as nr_listing,
        borough,
        room_type
FROM prices p
JOIN room_types rt
    ON p.listing_id = rt.listing_id
GROUP BY borough, room_type
ORDER BY borough;

5.How many listings in each room type category have a 
price of over $500 per night?
SELECT COUNT(p.listing_id) as nr_listings,
        room_type
FROM prices p
JOIN room_types rt
    ON p.listing_id = rt.listing_id
WHERE p.price > 500
GROUP BY room_type;
1 - shared room
395 - entire home/apt
19 - private room

6.What is the distribution of listing prices by neighborhood?
SELECT MAX(price) as max_price,
        MIN(price) as min_price,
        AVG(price) as avg_price,
        borough
FROM prices
GROUP BY borough;

7.What is the estimated amount of revenue generated by hosts in each borough?
with ct_1 as (
SELECT SUM(price) as revenue,
        borough,
        booked_days_365
FROM prices p
JOIN reviews r
    ON p.listing_id = r.listing_id
GROUP BY borough, booked_days_365),

ct_2 as(
SELECT (revenue * booked_days_365) as total_revenue,
    borough
FROM ct_1
GROUP BY borough, ct_1.revenue,ct_1.booked_days_365)

SELECT SUM(total_revenue) as total,
        borough
FROM ct_2
GROUP BY borough;

8.What is the average number of reviews per month for listings in each neighborhood?
SELECT AVG(price_per_month) as avg_price_month,
        neighbourhood,
        room_type
FROM prices p
JOIN room_types rt
   ON p.listing_id = rt.listing_id
GROUP BY neighbourhood, room_type
ORDER BY avg_price_month DESC;

9.How many listings have no reviews?
SELECT COUNT(rt.listing_id)
FROM room_types rt 
left join reviews r 
  ON rt.listing_id = r.listing_id
WHERE reviews_per_month is NULL;


10.How do the estimated book days correlate with the price of an Airbnb listing in New York City?
SELECT CORR(price, booked_days_365)
FROM prices p
JOIN reviews r
    ON p.listing_id = r.listing_id
-0.0796



















